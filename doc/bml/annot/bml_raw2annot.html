<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of bml_raw2annot</title>
  <meta name="keywords" content="bml_raw2annot">
  <meta name="description" content="BML_RAW2ANNOT creates an annotation table from a raw">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">bml</a> &gt; <a href="index.html">annot</a> &gt; bml_raw2annot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for bml\annot&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>bml_raw2annot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>BML_RAW2ANNOT creates an annotation table from a raw</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function annot = bml_raw2annot(raw) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> BML_RAW2ANNOT creates an annotation table from a raw

 raw - FT_DATATYPE_RAW

 returns an ANNOT table with variables
   'id' corresponds to the trial
   'starts' time represented by the trial
     'ends' time represented by the trial
   'duration' in seconds
   's1' double, first sample sync coord
   't1' double, time of first sample sample sync coord
   's2' double, second sample sync coord
   't2' double, time of second sample sample sync coord
   'Fs' double, sampling rate
   'nSamples' double, number of samples in raw</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="bml_annot_table.html" class="code" title="function annot=bml_annot_table(x, description, x_var_name)">bml_annot_table</a>	BML_ANNOT_TABLE transforms a table into an annotations table [internal]</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="bml_annot2raw.html" class="code" title="function raw = bml_annot2raw(cfg, annot)">bml_annot2raw</a>	BML_ANNOT2RAW creates a ft_datatype_raw of zeros with ones at annot times</li><li><a href="bml_annot2spike.html" class="code" title="function spike = bml_annot2spike(cfg, annot, raw)">bml_annot2spike</a>	BML_ANNOT2SPIKE creates a ft_datatype_spike structure from an annotation table</li><li><a href="../../bml/signal/bml_conform_to.html" class="code" title="function conformed = bml_conform_to(master, slave)">bml_conform_to</a>	BML_CONFORM_TO conforms a slave ft_datatype_raw to the master's time</li><li><a href="../../bml/signal/bml_redefinetrial.html" class="code" title="function [redefined, redefined_epoch] = bml_redefinetrial(cfg, raw)">bml_redefinetrial</a>	BML_REDEFINETRIAL creates new epoching from a raw object (not necessarily continuous)</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function annot = bml_raw2annot(raw)</a>
0002 
0003 <span class="comment">% BML_RAW2ANNOT creates an annotation table from a raw</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% raw - FT_DATATYPE_RAW</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% returns an ANNOT table with variables</span>
0008 <span class="comment">%   'id' corresponds to the trial</span>
0009 <span class="comment">%   'starts' time represented by the trial</span>
0010 <span class="comment">%     'ends' time represented by the trial</span>
0011 <span class="comment">%   'duration' in seconds</span>
0012 <span class="comment">%   's1' double, first sample sync coord</span>
0013 <span class="comment">%   't1' double, time of first sample sample sync coord</span>
0014 <span class="comment">%   's2' double, second sample sync coord</span>
0015 <span class="comment">%   't2' double, time of second sample sample sync coord</span>
0016 <span class="comment">%   'Fs' double, sampling rate</span>
0017 <span class="comment">%   'nSamples' double, number of samples in raw</span>
0018 
0019 annot = table();
0020 <span class="keyword">for</span> i=1:numel(raw.trial)
0021   id = i;
0022   nSamples = size(raw.trial{i},2);
0023   
0024   <span class="keyword">if</span> ismember(<span class="string">'fsample'</span>,fields(raw))
0025     Fs = raw.fsample;
0026   <span class="keyword">else</span>
0027     Fs = round(1/mean(diff(raw.time{i})),9,<span class="string">'significant'</span>);
0028   <span class="keyword">end</span>
0029   
0030 <span class="comment">%   if ismember('sampleinfo',fields(raw))</span>
0031 <span class="comment">%     s1 = raw.sampleinfo(i,1);</span>
0032 <span class="comment">%     s2 = raw.sampleinfo(i,2);</span>
0033 <span class="comment">%   else</span>
0034 <span class="comment">%     s1 = 1;</span>
0035 <span class="comment">%     s2 = nSamples;</span>
0036 <span class="comment">%   end</span>
0037   s1 = 1;
0038   s2 = nSamples;     
0039 
0040   t1 = raw.time{i}(1);
0041   t2 = raw.time{i}(end);
0042   
0043   starts = t1 - 0.5/Fs;
0044   ends = t2 + 0.5/Fs;
0045   
0046   annot = [annot; table(id,starts,ends,s1,t1,s2,t2,Fs,nSamples)];
0047   
0048 <span class="keyword">end</span>
0049 
0050 annot = <a href="bml_annot_table.html" class="code" title="function annot=bml_annot_table(x, description, x_var_name)">bml_annot_table</a>(annot,inputname(1));</pre></div>
<hr><address>Generated on Tue 25-Sep-2018 10:08:19 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>